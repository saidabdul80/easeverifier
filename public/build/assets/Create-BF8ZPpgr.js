import{d as E,g as J,k as X,m as G,r,c as _,o as d,a as t,u as n,h as Q,w as l,b,e as s,t as N,i as W,p as V,q as P,s as Y,v as Z,F as k,f as A}from"./app-cosHoKij.js";import{_ as ee}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DRizawYi.js";import"./index-p5wq9x94.js";const te={class:"mb-6"},le={class:"text-body-2 text-grey"},ae={class:"d-flex justify-end ga-2"},re=E({__name:"Create",props:{service:{},authTypes:{},httpMethods:{}},setup(f){const B=f,o=J({name:"",base_url:"",endpoint:"",http_method:"POST",auth_type:"bearer",auth_config:{},request_headers:[],request_body_template:[],response_mapping:[],timeout:30,priority:1,is_active:!0,environment:"live"}),M=[{value:"live",label:"Live (Production)",color:"success"},{value:"test",label:"Test (Sandbox)",color:"warning"}],I=X(()=>{switch(o.auth_type){case"bearer":return[{key:"token",label:"Bearer Token",type:"password",hint:"The bearer token for Authorization header"}];case"api_key_header":return[{key:"header_name",label:"Header Name",type:"text",hint:"e.g., X-API-Key, Authorization"},{key:"header_value",label:"Header Value",type:"password",hint:"The API key value"}];case"api_key_body":return[{key:"key_name",label:"Key Name",type:"text",hint:"e.g., api_key, apiKey"},{key:"key_value",label:"Key Value",type:"password",hint:"The API key value"}];case"basic":return[{key:"username",label:"Username",type:"text",hint:"Basic auth username"},{key:"password",label:"Password",type:"password",hint:"Basic auth password"}];case"custom":return[{key:"custom_headers",label:"Custom Headers (JSON)",type:"textarea",hint:'{"Header-Name": "value"}'}];default:return[]}});G(()=>o.auth_type,()=>{o.auth_config={}});const z=()=>o.request_headers.push({key:"",value:""}),H=u=>o.request_headers.splice(u,1),$=()=>o.request_body_template.push({key:"",value:""}),R=u=>o.request_body_template.splice(u,1),F=()=>o.response_mapping.push({key:"",value:""}),K=u=>o.response_mapping.splice(u,1),C=u=>u.reduce((e,p)=>(p.key&&(e[p.key]=p.value),e),{}),S=()=>{o.transform(u=>({...u,request_headers:C(u.request_headers),request_body_template:C(u.request_body_template),response_mapping:C(u.response_mapping)})).post(`/admin/services/${B.service.id}/providers`)};return(u,e)=>{const p=r("v-btn"),y=r("v-icon"),g=r("v-card-title"),v=r("v-text-field"),T=r("v-select"),c=r("v-col"),h=r("v-row"),j=r("v-list-item"),w=r("v-alert"),L=r("v-switch"),x=r("v-card-text"),U=r("v-card"),O=r("v-textarea"),q=r("v-spacer"),D=r("v-form");return d(),_(k,null,[t(n(Q),{title:`Add Provider - ${f.service.name}`},null,8,["title"]),t(ee,{user:u.$page.props.auth.user},{default:l(()=>[b("div",te,[t(p,{variant:"text","prepend-icon":"mdi-arrow-left",href:`/admin/services/${f.service.id}`,class:"mb-2"},{default:l(()=>[s("Back to "+N(f.service.name),1)]),_:1},8,["href"]),e[9]||(e[9]=b("h1",{class:"text-h4 font-weight-bold mb-1"},"Add Provider",-1)),b("p",le,"Configure a new API provider for "+N(f.service.name),1)]),t(D,{onSubmit:W(S,["prevent"])},{default:l(()=>[t(h,null,{default:l(()=>[t(c,{cols:"12",md:"6"},{default:l(()=>[t(U,{class:"mb-4"},{default:l(()=>[t(g,null,{default:l(()=>[t(y,{class:"mr-2"},{default:l(()=>[...e[10]||(e[10]=[s("mdi-information",-1)])]),_:1}),e[11]||(e[11]=s("Basic Information",-1))]),_:1}),t(x,null,{default:l(()=>[t(v,{modelValue:n(o).name,"onUpdate:modelValue":e[0]||(e[0]=a=>n(o).name=a),label:"Provider Name *",variant:"outlined",placeholder:"e.g., NIMC Direct API","error-messages":n(o).errors.name,class:"mb-4"},null,8,["modelValue","error-messages"]),t(v,{modelValue:n(o).base_url,"onUpdate:modelValue":e[1]||(e[1]=a=>n(o).base_url=a),label:"Base URL *",variant:"outlined",placeholder:"https://api.example.com","error-messages":n(o).errors.base_url,class:"mb-4"},null,8,["modelValue","error-messages"]),t(v,{modelValue:n(o).endpoint,"onUpdate:modelValue":e[2]||(e[2]=a=>n(o).endpoint=a),label:"Endpoint *",variant:"outlined",placeholder:"/v1/nin/verify",hint:"Use {{search_parameter}} for dynamic values","error-messages":n(o).errors.endpoint,class:"mb-4"},null,8,["modelValue","error-messages"]),t(T,{modelValue:n(o).http_method,"onUpdate:modelValue":e[3]||(e[3]=a=>n(o).http_method=a),items:f.httpMethods,label:"HTTP Method",variant:"outlined",class:"mb-4"},null,8,["modelValue","items"]),t(h,null,{default:l(()=>[t(c,{cols:"6"},{default:l(()=>[t(v,{modelValue:n(o).timeout,"onUpdate:modelValue":e[4]||(e[4]=a=>n(o).timeout=a),modelModifiers:{number:!0},label:"Timeout (seconds)",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(c,{cols:"6"},{default:l(()=>[t(v,{modelValue:n(o).priority,"onUpdate:modelValue":e[5]||(e[5]=a=>n(o).priority=a),modelModifiers:{number:!0},label:"Priority",type:"number",variant:"outlined",hint:"Lower = higher priority"},null,8,["modelValue"])]),_:1})]),_:1}),t(T,{modelValue:n(o).environment,"onUpdate:modelValue":e[6]||(e[6]=a=>n(o).environment=a),items:M,"item-title":"label","item-value":"value",label:"Environment *",variant:"outlined",class:"mb-4"},{item:l(({item:a,props:i})=>[t(j,Y(Z(i)),{prepend:l(()=>[t(y,{color:a.raw.color},{default:l(()=>[s(N(a.raw.value==="live"?"mdi-rocket-launch":"mdi-flask"),1)]),_:2},1032,["color"])]),_:2},1040)]),_:1},8,["modelValue"]),n(o).environment==="test"?(d(),V(w,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mb-4"},{default:l(()=>[...e[12]||(e[12]=[b("strong",null,"Test Mode:",-1),s(" API calls to this provider will return mock data and won't charge customers using test API keys. ",-1)])]),_:1})):P("",!0),t(L,{modelValue:n(o).is_active,"onUpdate:modelValue":e[7]||(e[7]=a=>n(o).is_active=a),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(c,{cols:"12",md:"6"},{default:l(()=>[t(U,{class:"mb-4"},{default:l(()=>[t(g,null,{default:l(()=>[t(y,{class:"mr-2"},{default:l(()=>[...e[13]||(e[13]=[s("mdi-shield-key",-1)])]),_:1}),e[14]||(e[14]=s("Authentication",-1))]),_:1}),t(x,null,{default:l(()=>[t(T,{modelValue:n(o).auth_type,"onUpdate:modelValue":e[8]||(e[8]=a=>n(o).auth_type=a),items:f.authTypes,"item-title":"label","item-value":"value",label:"Authentication Type",variant:"outlined",class:"mb-4"},null,8,["modelValue","items"]),(d(!0),_(k,null,A(I.value,a=>(d(),_(k,{key:a.key},[a.type==="textarea"?(d(),V(O,{key:0,modelValue:n(o).auth_config[a.key],"onUpdate:modelValue":i=>n(o).auth_config[a.key]=i,label:a.label,hint:a.hint,variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue","onUpdate:modelValue","label","hint"])):(d(),V(v,{key:1,modelValue:n(o).auth_config[a.key],"onUpdate:modelValue":i=>n(o).auth_config[a.key]=i,label:a.label,type:a.type,hint:a.hint,variant:"outlined","persistent-hint":"",class:"mb-4"},null,8,["modelValue","onUpdate:modelValue","label","type","hint"]))],64))),128)),n(o).auth_type==="none"?(d(),V(w,{key:0,type:"info",variant:"tonal",density:"compact"},{default:l(()=>[...e[15]||(e[15]=[s("No authentication will be used for this provider.",-1)])]),_:1})):P("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(c,{cols:"12",md:"6"},{default:l(()=>[t(U,{class:"mb-4"},{default:l(()=>[t(g,{class:"d-flex align-center"},{default:l(()=>[t(y,{class:"mr-2"},{default:l(()=>[...e[16]||(e[16]=[s("mdi-code-tags",-1)])]),_:1}),e[18]||(e[18]=s("Request Headers ",-1)),t(q),t(p,{size:"small",variant:"tonal",onClick:z},{default:l(()=>[...e[17]||(e[17]=[s("+ Add Header",-1)])]),_:1})]),_:1}),t(x,null,{default:l(()=>[(d(!0),_(k,null,A(n(o).request_headers,(a,i)=>(d(),_("div",{key:i,class:"d-flex ga-2 mb-2"},[t(v,{modelValue:a.key,"onUpdate:modelValue":m=>a.key=m,label:"Header Name",variant:"outlined",density:"compact","hide-details":"",placeholder:"Content-Type"},null,8,["modelValue","onUpdate:modelValue"]),t(v,{modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,label:"Value",variant:"outlined",density:"compact","hide-details":"",placeholder:"application/json"},null,8,["modelValue","onUpdate:modelValue"]),t(p,{icon:"",size:"small",color:"error",variant:"text",onClick:m=>H(i)},{default:l(()=>[t(y,null,{default:l(()=>[...e[19]||(e[19]=[s("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]))),128)),n(o).request_headers.length?P("",!0):(d(),V(w,{key:0,type:"info",variant:"tonal",density:"compact"},{default:l(()=>[...e[20]||(e[20]=[s(" Add custom headers like Content-Type, Accept, etc. ",-1)])]),_:1}))]),_:1})]),_:1})]),_:1}),t(c,{cols:"12",md:"6"},{default:l(()=>[t(U,{class:"mb-4"},{default:l(()=>[t(g,{class:"d-flex align-center"},{default:l(()=>[t(y,{class:"mr-2"},{default:l(()=>[...e[21]||(e[21]=[s("mdi-code-braces",-1)])]),_:1}),e[23]||(e[23]=s("Request Body Template ",-1)),t(q),t(p,{size:"small",variant:"tonal",onClick:$},{default:l(()=>[...e[22]||(e[22]=[s("+ Add Parameter",-1)])]),_:1})]),_:1}),t(x,null,{default:l(()=>[(d(!0),_(k,null,A(n(o).request_body_template,(a,i)=>(d(),_("div",{key:i,class:"d-flex ga-2 mb-2"},[t(v,{modelValue:a.key,"onUpdate:modelValue":m=>a.key=m,label:"Key",variant:"outlined",density:"compact","hide-details":"",placeholder:"nin"},null,8,["modelValue","onUpdate:modelValue"]),t(v,{modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,label:"Value",variant:"outlined",density:"compact","hide-details":"",placeholder:"{{search_parameter}}"},null,8,["modelValue","onUpdate:modelValue"]),t(p,{icon:"",size:"small",color:"error",variant:"text",onClick:m=>R(i)},{default:l(()=>[t(y,null,{default:l(()=>[...e[24]||(e[24]=[s("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]))),128)),t(w,{type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>[...e[25]||(e[25]=[s(" Use ",-1),b("code",null,"{{search_parameter}}",-1),s(" to insert the verification value. ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(c,{cols:"12"},{default:l(()=>[t(U,{class:"mb-4"},{default:l(()=>[t(g,{class:"d-flex align-center"},{default:l(()=>[t(y,{class:"mr-2"},{default:l(()=>[...e[26]||(e[26]=[s("mdi-swap-horizontal",-1)])]),_:1}),e[28]||(e[28]=s("Response Mapping ",-1)),t(q),t(p,{size:"small",variant:"tonal",onClick:F},{default:l(()=>[...e[27]||(e[27]=[s("+ Add Mapping",-1)])]),_:1})]),_:1}),t(x,null,{default:l(()=>[e[32]||(e[32]=b("p",{class:"text-body-2 text-grey mb-4"},"Map the API response fields to standard field names. Use dot notation for nested values (e.g., data.firstName).",-1)),(d(!0),_(k,null,A(n(o).response_mapping,(a,i)=>(d(),V(h,{key:i,class:"mb-2"},{default:l(()=>[t(c,{cols:"5"},{default:l(()=>[t(v,{modelValue:a.key,"onUpdate:modelValue":m=>a.key=m,label:"Our Field",variant:"outlined",density:"compact","hide-details":"",placeholder:"first_name"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(c,{cols:"1",class:"d-flex align-center justify-center"},{default:l(()=>[t(y,null,{default:l(()=>[...e[29]||(e[29]=[s("mdi-arrow-left",-1)])]),_:1})]),_:1}),t(c,{cols:"5"},{default:l(()=>[t(v,{modelValue:a.value,"onUpdate:modelValue":m=>a.value=m,label:"API Response Path",variant:"outlined",density:"compact","hide-details":"",placeholder:"data.firstName"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(c,{cols:"1",class:"d-flex align-center"},{default:l(()=>[t(p,{icon:"",size:"small",color:"error",variant:"text",onClick:m=>K(i)},{default:l(()=>[t(y,null,{default:l(()=>[...e[30]||(e[30]=[s("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),n(o).response_mapping.length?P("",!0):(d(),V(w,{key:0,type:"info",variant:"tonal",density:"compact"},{default:l(()=>[...e[31]||(e[31]=[s(" Define how to extract data from the API response. ",-1)])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),b("div",ae,[t(p,{variant:"outlined",href:`/admin/services/${f.service.id}`},{default:l(()=>[...e[33]||(e[33]=[s("Cancel",-1)])]),_:1},8,["href"]),t(p,{color:"primary",type:"submit",loading:n(o).processing,"prepend-icon":"mdi-content-save"},{default:l(()=>[...e[34]||(e[34]=[s("Create Provider",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1},8,["user"])],64)}}});export{re as default};
