import{d as G,u as Q,p as W,r as i,c as b,o as u,a as t,b as n,h as Y,w as l,e as V,f as r,t as A,g as Z,m as k,n as C,q as ee,s as te,F as g,l as T,k as z}from"./app-COaOSKoI.js";import{_ as le}from"./AdminLayout.vue_vue_type_script_setup_true_lang-jC1nLA55.js";import"./index-Dz1Zefys.js";const ae={class:"d-flex align-center mb-6"},oe={class:"text-body-2 text-grey"},ne={class:"d-flex justify-end ga-2"},ie=G({__name:"Edit",props:{provider:{},service:{},authTypes:{},httpMethods:{}},setup(_){const d=_,N=m=>m?Object.entries(m).map(([e,s])=>({key:e,value:s})):[],o=Q({name:d.provider.name,base_url:d.provider.base_url,endpoint:d.provider.endpoint,http_method:d.provider.http_method,auth_type:d.provider.auth_type,auth_config:d.provider.auth_config||{},request_headers:N(d.provider.request_headers),request_body_template:N(d.provider.request_body_template),response_mapping:N(d.provider.response_mapping),timeout:d.provider.timeout,priority:d.provider.priority,is_active:d.provider.is_active,environment:d.provider.environment||"live"}),H=[{value:"live",label:"Live (Production)",color:"success"},{value:"test",label:"Test (Sandbox)",color:"warning"}],$=W(()=>{switch(o.auth_type){case"bearer":return[{key:"token",label:"Bearer Token",type:"password",hint:"The bearer token for Authorization header"}];case"api_key_header":return[{key:"header_name",label:"Header Name",type:"text",hint:"e.g., X-API-Key, Authorization"},{key:"header_value",label:"Header Value",type:"password",hint:"The API key value"}];case"api_key_body":return[{key:"key_name",label:"Key Name",type:"text",hint:"e.g., api_key, apiKey"},{key:"key_value",label:"Key Value",type:"password",hint:"The API key value"}];case"basic":return[{key:"username",label:"Username",type:"text",hint:"Basic auth username"},{key:"password",label:"Password",type:"password",hint:"Basic auth password"}];case"custom":return[{key:"custom_headers",label:"Custom Headers (JSON)",type:"textarea",hint:'{"Header-Name": "value"}'}];default:return[]}}),I=()=>o.request_headers.push({key:"",value:""}),R=m=>o.request_headers.splice(m,1),E=()=>o.request_body_template.push({key:"",value:""}),j=m=>o.request_body_template.splice(m,1),F=()=>o.response_mapping.push({key:"",value:""}),K=m=>o.response_mapping.splice(m,1),B=m=>m.reduce((e,s)=>(s.key&&(e[s.key]=s.value),e),{}),L=()=>{const m={...o.data(),request_headers:B(o.request_headers),request_body_template:B(o.request_body_template),response_mapping:B(o.response_mapping)};z.put(`/admin/providers/${d.provider.id}`,m)},O=()=>{confirm("Are you sure you want to delete this provider?")&&z.delete(`/admin/providers/${d.provider.id}`)};return(m,e)=>{const s=i("v-btn"),q=i("v-spacer"),c=i("v-icon"),h=i("v-card-title"),y=i("v-text-field"),M=i("v-select"),f=i("v-col"),U=i("v-row"),S=i("v-list-item"),x=i("v-alert"),D=i("v-switch"),w=i("v-card-text"),P=i("v-card"),J=i("v-textarea"),X=i("v-form");return u(),b(g,null,[t(n(Y),{title:`Edit Provider - ${_.provider.name}`},null,8,["title"]),t(le,{user:m.$page.props.auth.user},{default:l(()=>[V("div",ae,[V("div",null,[t(s,{variant:"text","prepend-icon":"mdi-arrow-left",href:`/admin/services/${_.service.id}`,class:"mb-2"},{default:l(()=>[r("Back to "+A(_.service.name),1)]),_:1},8,["href"]),e[9]||(e[9]=V("h1",{class:"text-h4 font-weight-bold mb-1"},"Edit Provider",-1)),V("p",oe,A(_.provider.name)+" for "+A(_.service.name),1)]),t(q),t(s,{color:"error",variant:"outlined","prepend-icon":"mdi-delete",onClick:O},{default:l(()=>[...e[10]||(e[10]=[r("Delete",-1)])]),_:1})]),t(X,{onSubmit:Z(L,["prevent"])},{default:l(()=>[t(U,null,{default:l(()=>[t(f,{cols:"12",md:"6"},{default:l(()=>[t(P,{class:"mb-4"},{default:l(()=>[t(h,null,{default:l(()=>[t(c,{class:"mr-2"},{default:l(()=>[...e[11]||(e[11]=[r("mdi-information",-1)])]),_:1}),e[12]||(e[12]=r("Basic Information",-1))]),_:1}),t(w,null,{default:l(()=>[t(y,{modelValue:n(o).name,"onUpdate:modelValue":e[0]||(e[0]=a=>n(o).name=a),label:"Provider Name *",variant:"outlined","error-messages":n(o).errors.name,class:"mb-4"},null,8,["modelValue","error-messages"]),t(y,{modelValue:n(o).base_url,"onUpdate:modelValue":e[1]||(e[1]=a=>n(o).base_url=a),label:"Base URL *",variant:"outlined","error-messages":n(o).errors.base_url,class:"mb-4"},null,8,["modelValue","error-messages"]),t(y,{modelValue:n(o).endpoint,"onUpdate:modelValue":e[2]||(e[2]=a=>n(o).endpoint=a),label:"Endpoint *",variant:"outlined",hint:"Use {{search_parameter}} for dynamic values","error-messages":n(o).errors.endpoint,class:"mb-4"},null,8,["modelValue","error-messages"]),t(M,{modelValue:n(o).http_method,"onUpdate:modelValue":e[3]||(e[3]=a=>n(o).http_method=a),items:_.httpMethods,label:"HTTP Method",variant:"outlined",class:"mb-4"},null,8,["modelValue","items"]),t(U,null,{default:l(()=>[t(f,{cols:"6"},{default:l(()=>[t(y,{modelValue:n(o).timeout,"onUpdate:modelValue":e[4]||(e[4]=a=>n(o).timeout=a),modelModifiers:{number:!0},label:"Timeout (seconds)",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(f,{cols:"6"},{default:l(()=>[t(y,{modelValue:n(o).priority,"onUpdate:modelValue":e[5]||(e[5]=a=>n(o).priority=a),modelModifiers:{number:!0},label:"Priority",type:"number",variant:"outlined",hint:"Lower = higher priority"},null,8,["modelValue"])]),_:1})]),_:1}),t(M,{modelValue:n(o).environment,"onUpdate:modelValue":e[6]||(e[6]=a=>n(o).environment=a),items:H,"item-title":"label","item-value":"value",label:"Environment *",variant:"outlined",class:"mb-4"},{item:l(({item:a,props:p})=>[t(S,ee(te(p)),{prepend:l(()=>[t(c,{color:a.raw.color},{default:l(()=>[r(A(a.raw.value==="live"?"mdi-rocket-launch":"mdi-flask"),1)]),_:2},1032,["color"])]),_:2},1040)]),_:1},8,["modelValue"]),n(o).environment==="test"?(u(),k(x,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mb-4"},{default:l(()=>[...e[13]||(e[13]=[V("strong",null,"Test Mode:",-1),r(" API calls to this provider will return mock data and won't charge customers using test API keys. ",-1)])]),_:1})):C("",!0),t(D,{modelValue:n(o).is_active,"onUpdate:modelValue":e[7]||(e[7]=a=>n(o).is_active=a),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(f,{cols:"12",md:"6"},{default:l(()=>[t(P,{class:"mb-4"},{default:l(()=>[t(h,null,{default:l(()=>[t(c,{class:"mr-2"},{default:l(()=>[...e[14]||(e[14]=[r("mdi-shield-key",-1)])]),_:1}),e[15]||(e[15]=r("Authentication",-1))]),_:1}),t(w,null,{default:l(()=>[t(M,{modelValue:n(o).auth_type,"onUpdate:modelValue":e[8]||(e[8]=a=>n(o).auth_type=a),items:_.authTypes,"item-title":"label","item-value":"value",label:"Authentication Type",variant:"outlined",class:"mb-4"},null,8,["modelValue","items"]),(u(!0),b(g,null,T($.value,a=>(u(),b(g,{key:a.key},[a.type==="textarea"?(u(),k(J,{key:0,modelValue:n(o).auth_config[a.key],"onUpdate:modelValue":p=>n(o).auth_config[a.key]=p,label:a.label,hint:a.hint,variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue","onUpdate:modelValue","label","hint"])):(u(),k(y,{key:1,modelValue:n(o).auth_config[a.key],"onUpdate:modelValue":p=>n(o).auth_config[a.key]=p,label:a.label,type:a.type,hint:a.hint,variant:"outlined","persistent-hint":"",class:"mb-4"},null,8,["modelValue","onUpdate:modelValue","label","type","hint"]))],64))),128)),n(o).auth_type==="none"?(u(),k(x,{key:0,type:"info",variant:"tonal",density:"compact"},{default:l(()=>[...e[16]||(e[16]=[r("No authentication will be used.",-1)])]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(U,null,{default:l(()=>[t(f,{cols:"12",md:"6"},{default:l(()=>[t(P,{class:"mb-4"},{default:l(()=>[t(h,{class:"d-flex align-center"},{default:l(()=>[t(c,{class:"mr-2"},{default:l(()=>[...e[17]||(e[17]=[r("mdi-code-tags",-1)])]),_:1}),e[19]||(e[19]=r("Request Headers ",-1)),t(q),t(s,{size:"small",variant:"tonal",onClick:I},{default:l(()=>[...e[18]||(e[18]=[r("+ Add Header",-1)])]),_:1})]),_:1}),t(w,null,{default:l(()=>[(u(!0),b(g,null,T(n(o).request_headers,(a,p)=>(u(),b("div",{key:p,class:"d-flex ga-2 mb-2"},[t(y,{modelValue:a.key,"onUpdate:modelValue":v=>a.key=v,label:"Header Name",variant:"outlined",density:"compact","hide-details":"",placeholder:"Content-Type"},null,8,["modelValue","onUpdate:modelValue"]),t(y,{modelValue:a.value,"onUpdate:modelValue":v=>a.value=v,label:"Value",variant:"outlined",density:"compact","hide-details":"",placeholder:"application/json"},null,8,["modelValue","onUpdate:modelValue"]),t(s,{icon:"",size:"small",color:"error",variant:"text",onClick:v=>R(p)},{default:l(()=>[t(c,null,{default:l(()=>[...e[20]||(e[20]=[r("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]))),128)),n(o).request_headers.length?C("",!0):(u(),k(x,{key:0,type:"info",variant:"tonal",density:"compact"},{default:l(()=>[...e[21]||(e[21]=[r("No custom headers configured.",-1)])]),_:1}))]),_:1})]),_:1})]),_:1}),t(f,{cols:"12",md:"6"},{default:l(()=>[t(P,{class:"mb-4"},{default:l(()=>[t(h,{class:"d-flex align-center"},{default:l(()=>[t(c,{class:"mr-2"},{default:l(()=>[...e[22]||(e[22]=[r("mdi-code-braces",-1)])]),_:1}),e[24]||(e[24]=r("Request Body Template ",-1)),t(q),t(s,{size:"small",variant:"tonal",onClick:E},{default:l(()=>[...e[23]||(e[23]=[r("+ Add Parameter",-1)])]),_:1})]),_:1}),t(w,null,{default:l(()=>[(u(!0),b(g,null,T(n(o).request_body_template,(a,p)=>(u(),b("div",{key:p,class:"d-flex ga-2 mb-2"},[t(y,{modelValue:a.key,"onUpdate:modelValue":v=>a.key=v,label:"Key",variant:"outlined",density:"compact","hide-details":"",placeholder:"nin"},null,8,["modelValue","onUpdate:modelValue"]),t(y,{modelValue:a.value,"onUpdate:modelValue":v=>a.value=v,label:"Value",variant:"outlined",density:"compact","hide-details":"",placeholder:"{{search_parameter}}"},null,8,["modelValue","onUpdate:modelValue"]),t(s,{icon:"",size:"small",color:"error",variant:"text",onClick:v=>j(p)},{default:l(()=>[t(c,null,{default:l(()=>[...e[25]||(e[25]=[r("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]))),128)),t(x,{type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>[...e[26]||(e[26]=[r(" Use ",-1),V("code",null,"{{search_parameter}}",-1),r(" to insert the verification value. ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(U,null,{default:l(()=>[t(f,{cols:"12"},{default:l(()=>[t(P,{class:"mb-4"},{default:l(()=>[t(h,{class:"d-flex align-center"},{default:l(()=>[t(c,{class:"mr-2"},{default:l(()=>[...e[27]||(e[27]=[r("mdi-swap-horizontal",-1)])]),_:1}),e[29]||(e[29]=r("Response Mapping ",-1)),t(q),t(s,{size:"small",variant:"tonal",onClick:F},{default:l(()=>[...e[28]||(e[28]=[r("+ Add Mapping",-1)])]),_:1})]),_:1}),t(w,null,{default:l(()=>[e[33]||(e[33]=V("p",{class:"text-body-2 text-grey mb-4"},"Map the API response fields to standard field names. Use dot notation for nested values.",-1)),(u(!0),b(g,null,T(n(o).response_mapping,(a,p)=>(u(),k(U,{key:p,class:"mb-2"},{default:l(()=>[t(f,{cols:"5"},{default:l(()=>[t(y,{modelValue:a.key,"onUpdate:modelValue":v=>a.key=v,label:"Our Field",variant:"outlined",density:"compact","hide-details":"",placeholder:"first_name"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(f,{cols:"1",class:"d-flex align-center justify-center"},{default:l(()=>[t(c,null,{default:l(()=>[...e[30]||(e[30]=[r("mdi-arrow-left",-1)])]),_:1})]),_:1}),t(f,{cols:"5"},{default:l(()=>[t(y,{modelValue:a.value,"onUpdate:modelValue":v=>a.value=v,label:"API Response Path",variant:"outlined",density:"compact","hide-details":"",placeholder:"data.firstName"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(f,{cols:"1",class:"d-flex align-center"},{default:l(()=>[t(s,{icon:"",size:"small",color:"error",variant:"text",onClick:v=>K(p)},{default:l(()=>[t(c,null,{default:l(()=>[...e[31]||(e[31]=[r("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),n(o).response_mapping.length?C("",!0):(u(),k(x,{key:0,type:"info",variant:"tonal",density:"compact"},{default:l(()=>[...e[32]||(e[32]=[r("No response mappings configured.",-1)])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),V("div",ne,[t(s,{variant:"outlined",href:`/admin/services/${_.service.id}`},{default:l(()=>[...e[34]||(e[34]=[r("Cancel",-1)])]),_:1},8,["href"]),t(s,{color:"primary",type:"submit",loading:n(o).processing,"prepend-icon":"mdi-content-save"},{default:l(()=>[...e[35]||(e[35]=[r("Update Provider",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1},8,["user"])],64)}}});export{ie as default};
