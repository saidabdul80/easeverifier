import{d as C,i as h,p as w,u as T,r as n,m as p,o as l,w as r,a as s,e as y,b as o,h as E,f as a,t as v,g,c as R,n as z}from"./app-CsJ2IiSe.js";import{_ as B}from"./AuthLayout.vue_vue_type_script_setup_true_lang-B-MgvLN3.js";import{s as F}from"./index-Bbo4RtDD.js";import"./index-Dz1Zefys.js";const N={class:"text-center mb-6"},U={key:0,class:"text-error text-caption text-center mb-4"},S={class:"text-center"},q=C({__name:"TwoFactorChallenge",setup(A){const c=h(!1),i=w(()=>c.value?{title:"Recovery Code",description:"Enter one of your emergency recovery codes to access your account.",toggleText:"Use authentication code instead",icon:"mdi-key-variant"}:{title:"Two-Factor Authentication",description:"Enter the 6-digit code from your authenticator app.",toggleText:"Use recovery code instead",icon:"mdi-cellphone-key"}),e=T({code:"",recovery_code:""}),b=()=>{c.value=!c.value,e.clearErrors(),e.reset()},_=()=>{e.post(F())};return(M,t)=>{const d=n("v-icon"),x=n("v-avatar"),k=n("v-otp-input"),m=n("v-btn"),f=n("v-form"),V=n("v-text-field");return l(),p(B,{title:i.value.title,description:i.value.description},{default:r(()=>[s(o(E),{title:"Two-Factor Authentication - EaseVerifier"}),y("div",N,[s(x,{color:"primary-lighten-5",size:"80",class:"mb-4"},{default:r(()=>[s(d,{color:"primary",size:"40"},{default:r(()=>[a(v(i.value.icon),1)]),_:1})]),_:1})]),c.value?(l(),p(f,{key:1,onSubmit:g(_,["prevent"])},{default:r(()=>[s(V,{modelValue:o(e).recovery_code,"onUpdate:modelValue":t[1]||(t[1]=u=>o(e).recovery_code=u),label:"Recovery Code","prepend-inner-icon":"mdi-key",placeholder:"Enter your recovery code","error-messages":o(e).errors.recovery_code,autofocus:"",class:"mb-4"},null,8,["modelValue","error-messages"]),s(m,{type:"submit",color:"primary",size:"x-large",block:"",loading:o(e).processing,disabled:o(e).processing||!o(e).recovery_code,class:"mb-4"},{default:r(()=>[s(d,{start:""},{default:r(()=>[...t[4]||(t[4]=[a("mdi-check-circle",-1)])]),_:1}),t[5]||(t[5]=a(" Verify Recovery Code ",-1))]),_:1},8,["loading","disabled"])]),_:1})):(l(),p(f,{key:0,onSubmit:g(_,["prevent"])},{default:r(()=>[s(k,{modelValue:o(e).code,"onUpdate:modelValue":t[0]||(t[0]=u=>o(e).code=u),length:6,type:"number",error:!!o(e).errors.code,class:"mb-2"},null,8,["modelValue","error"]),o(e).errors.code?(l(),R("p",U,v(o(e).errors.code),1)):z("",!0),s(m,{type:"submit",color:"primary",size:"x-large",block:"",loading:o(e).processing,disabled:o(e).processing||o(e).code.length<6,class:"mb-4"},{default:r(()=>[s(d,{start:""},{default:r(()=>[...t[2]||(t[2]=[a("mdi-check-circle",-1)])]),_:1}),t[3]||(t[3]=a(" Verify Code ",-1))]),_:1},8,["loading","disabled"])]),_:1})),y("div",S,[s(m,{variant:"text",color:"primary",onClick:b},{default:r(()=>[a(v(i.value.toggleText),1)]),_:1})])]),_:1},8,["title","description"])}}});export{q as default};
